<div class="container">
  <div class="row">
      <div class="col-4 info">
        <div class="card bg-transparent">
          <div class="card-detail mb-10">
            <header class="card-header">
              <h5 class="card-header-title">
                <div class="user-name">
                 <% if @restaurant_review.customer.image.attached? %>
                    <%= image_tag @restaurant_review.customer.image, class: "rounded-circle", size: "100x100" %>
                  <% else %>
                    <%= image_tag 'no_image', size: "100x100" %>
                  <% end %>
                  <%= @restaurant_review.customer.user_name %>
                </div>
              </h5>
            </header>

            <div class="review-rating" data-score=<%= @restaurant_review.restaurant_score %>></div>
            <p>使用額：<%= @restaurant_review.restaurant_price %>円</p>
            <p class="tag">
              トピック：<% @restaurant_review.restaurant_tags.each do |tag| %>
                <%= tag.name %>
              <% end %>
            </p>
            <p>感想：<%= @restaurant_review.restaurant_content %></p>
          </div>
        </div>
       </div>

          <div class="col-8">
            <div class="form-group" style="margin-top: 80px;">
              <%= render "errors" %>
              <%= form_with model: [@restaurant_review, @restaurant_comment], url: restaurant_restaurant_review_restaurant_comments_path(@restaurant, @restaurant_review) do |f| %>
                <%= f.text_area :content, rows: '3', placeholder: "コメントをここに", class: "form-control"  %>
                <%= f.submit "送信する" %>
              <% end %>
            </div>

            <!--コメント-->
            <table class="table table-primary">
              <thead>
                <tr>
                  <th scope="col">ユーザー名</th>
                  <th scope="col">コメント</th>
                  <th></th>
                </tr>
              </thead>

              <tbody>
                <% @restaurant_comments.each do |comment| %>
                  <tr>
                    <td><%= comment.customer.user_name %></td>
                    <td><%= comment.content %></td>
                    <td>
                      <% if customer = current_customer %>
                      <%= link_to "削除する", restaurant_restaurant_review_restaurant_comment_path(@restaurant, @restaurant_review, comment.id), method: :delete, "data-confirm" => "本当に削除しますか？" %>
                      <% end %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
            <!--コメントここまで-->
        <div class="review-button"><%= link_to "戻る",  restaurant_path(@restaurant.id), class: "btn btn btn-primary text-white" %></div>
      </div>
    </div>
  </div>
</section>

  <script>
	$('.average-review-rating').empty().raty({
	  half: true,
		readOnly: true,
    starOn: "<%= asset_path('star-on.png') %>",
    starOff: "<%= asset_path('star-off.png') %>",
    starHalf: "<%= asset_path('star-half.png') %>",
	});
</script>

<script>
  var swiper = new Swiper(".mySwiper", {

    navigation: {
      nextEl: ".swiper-button-next",
      prevEl: ".swiper-button-prev",
    },
    pagination: {
    el: ".swiper-pagination"
    },
  });
</script>

  <script>
	$('.review-rating').empty().raty({
	  half: true,
		readOnly: true,
    starOn: "<%= asset_path('star-on.png') %>",
    starOff: "<%= asset_path('star-off.png') %>",
    starHalf: "<%= asset_path('star-half.png') %>",
	});
</script>